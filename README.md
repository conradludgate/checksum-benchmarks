# checksum benchmarks

Run with
```sh
RUSTFLAGS="-C target-cpu=native" DIVAN_SAMPLE_COUNT=10000 cargo +nightly bench
```

I've tried to use the most efficient checksum/hash function implementation in each case.

* sha1/sha2 will try to use hardware acceleration.
* blake3_mt will use rayon for parallelism

## Results

### Apple Macbook Pro M2 Max (aarch64-apple-darwin)

```
crc32     - 8.67 GB/s
blake3_mt - 7.94 GB/s
adler     - 5.65 GB/s
sha2_256  - 2.38 GB/s
sha1      - 2.35 GB/s
blake3    - 2.01 GB/s
blake2b   - 1.14 GB/s
md5       -  685 MB/s
blake2s   -  684 MB/s
sha3_256  -  625 MB/s
```

<details>
<summary>Expand full test info</summary>
```
Timer precision: 41 ns
checksums             fastest       │ slowest       │ median        │ mean          │ samples │ iters
├─ crypto                           │               │               │               │         │
│  ├─ blake                         │               │               │               │         │
│  │  ├─ blake2b_32                 │               │               │               │         │
│  │  │  ├─ 4096      4.332 µs      │ 60.29 µs      │ 5.624 µs      │ 6.119 µs      │ 10000   │ 10000
│  │  │  │            945.4 MB/s    │ 67.93 MB/s    │ 728.2 MB/s    │ 669.3 MB/s    │         │
│  │  │  ├─ 16384     14.08 µs      │ 47.83 µs      │ 14.24 µs      │ 14.92 µs      │ 10000   │ 10000
│  │  │  │            1.163 GB/s    │ 342.5 MB/s    │ 1.149 GB/s    │ 1.098 GB/s    │         │
│  │  │  ├─ 65536     56.58 µs      │ 98.66 µs      │ 56.83 µs      │ 57.6 µs       │ 10000   │ 10000
│  │  │  │            1.158 GB/s    │ 664.2 MB/s    │ 1.153 GB/s    │ 1.137 GB/s    │         │
│  │  │  ╰─ 1048576   907.6 µs      │ 1.715 ms      │ 911.9 µs      │ 919 µs        │ 10000   │ 10000
│  │  │               1.155 GB/s    │ 611.1 MB/s    │ 1.149 GB/s    │ 1.14 GB/s     │         │
│  │  ├─ blake2b_512                │               │               │               │         │
│  │  │  ├─ 4096      3.457 µs      │ 24.41 µs      │ 3.582 µs      │ 3.688 µs      │ 10000   │ 10000
│  │  │  │            1.184 GB/s    │ 167.7 MB/s    │ 1.143 GB/s    │ 1.11 GB/s     │         │
│  │  │  ├─ 16384     14.08 µs      │ 37.58 µs      │ 14.24 µs      │ 14.49 µs      │ 10000   │ 10000
│  │  │  │            1.163 GB/s    │ 435.9 MB/s    │ 1.149 GB/s    │ 1.13 GB/s     │         │
│  │  │  ├─ 65536     56.62 µs      │ 101 µs        │ 56.83 µs      │ 57.34 µs      │ 10000   │ 10000
│  │  │  │            1.157 GB/s    │ 648.6 MB/s    │ 1.153 GB/s    │ 1.142 GB/s    │         │
│  │  │  ╰─ 1048576   907.7 µs      │ 1.132 ms      │ 911.6 µs      │ 913.2 µs      │ 10000   │ 10000
│  │  │               1.155 GB/s    │ 925.5 MB/s    │ 1.15 GB/s     │ 1.148 GB/s    │         │
│  │  ├─ blake2s_256                │               │               │               │         │
│  │  │  ├─ 4096      5.874 µs      │ 19.37 µs      │ 5.999 µs      │ 6.092 µs      │ 10000   │ 10000
│  │  │  │            697.2 MB/s    │ 211.4 MB/s    │ 682.7 MB/s    │ 672.2 MB/s    │         │
│  │  │  ├─ 16384     23.7 µs       │ 43.95 µs      │ 23.83 µs      │ 24.12 µs      │ 10000   │ 10000
│  │  │  │            691 MB/s      │ 372.7 MB/s    │ 687.4 MB/s    │ 679 MB/s      │         │
│  │  │  ├─ 65536     95.04 µs      │ 137.4 µs      │ 95.33 µs      │ 95.97 µs      │ 10000   │ 10000
│  │  │  │            689.5 MB/s    │ 476.6 MB/s    │ 687.4 MB/s    │ 682.8 MB/s    │         │
│  │  │  ╰─ 1048576   1.523 ms      │ 1.77 ms       │ 1.527 ms      │ 1.531 ms      │ 10000   │ 10000
│  │  │               688.2 MB/s    │ 592.2 MB/s    │ 686.3 MB/s    │ 684.8 MB/s    │         │
│  │  ├─ blake2s_32                 │               │               │               │         │
│  │  │  ├─ 4096      5.874 µs      │ 18.37 µs      │ 5.999 µs      │ 6.213 µs      │ 10000   │ 10000
│  │  │  │            697.2 MB/s    │ 222.9 MB/s    │ 682.7 MB/s    │ 659.1 MB/s    │         │
│  │  │  ├─ 16384     23.66 µs      │ 59.83 µs      │ 23.87 µs      │ 24.56 µs      │ 10000   │ 10000
│  │  │  │            692.2 MB/s    │ 273.8 MB/s    │ 686.2 MB/s    │ 666.9 MB/s    │         │
│  │  │  ├─ 65536     95.04 µs      │ 143.7 µs      │ 95.33 µs      │ 96.16 µs      │ 10000   │ 10000
│  │  │  │            689.5 MB/s    │ 456 MB/s      │ 687.4 MB/s    │ 681.5 MB/s    │         │
│  │  │  ╰─ 1048576   1.523 ms      │ 1.83 ms       │ 1.527 ms      │ 1.531 ms      │ 10000   │ 10000
│  │  │               688.3 MB/s    │ 572.7 MB/s    │ 686.3 MB/s    │ 684.5 MB/s    │         │
│  │  ├─ blake3                     │               │               │               │         │
│  │  │  ├─ 4096      2.832 µs      │ 48.95 µs      │ 3.416 µs      │ 3.786 µs      │ 10000   │ 10000
│  │  │  │            1.446 GB/s    │ 83.66 MB/s    │ 1.198 GB/s    │ 1.081 GB/s    │         │
│  │  │  ├─ 16384     8.124 µs      │ 30.45 µs      │ 8.791 µs      │ 9.275 µs      │ 10000   │ 10000
│  │  │  │            2.016 GB/s    │ 537.9 MB/s    │ 1.863 GB/s    │ 1.766 GB/s    │         │
│  │  │  ├─ 65536     32.33 µs      │ 78.83 µs      │ 32.45 µs      │ 32.82 µs      │ 10000   │ 10000
│  │  │  │            2.026 GB/s    │ 831.3 MB/s    │ 2.019 GB/s    │ 1.996 GB/s    │         │
│  │  │  ╰─ 1048576   517.8 µs      │ 1.32 ms       │ 518.5 µs      │ 522.7 µs      │ 10000   │ 10000
│  │  │               2.024 GB/s    │ 794.2 MB/s    │ 2.022 GB/s    │ 2.005 GB/s    │         │
│  │  ╰─ blake3_mt                  │               │               │               │         │
│  │     ├─ 4096      2.04 µs       │ 15.29 µs      │ 2.124 µs      │ 2.188 µs      │ 10000   │ 10000
│  │     │            2.007 GB/s    │ 267.8 MB/s    │ 1.927 GB/s    │ 1.871 GB/s    │         │
│  │     ├─ 16384     9.332 µs      │ 386.1 µs      │ 22.95 µs      │ 29.41 µs      │ 10000   │ 10000
│  │     │            1.755 GB/s    │ 42.43 MB/s    │ 713.6 MB/s    │ 557 MB/s      │         │
│  │     ├─ 65536     13.91 µs      │ 213.2 µs      │ 38.49 µs      │ 42.83 µs      │ 10000   │ 10000
│  │     │            4.709 GB/s    │ 307.3 MB/s    │ 1.702 GB/s    │ 1.529 GB/s    │         │
│  │     ╰─ 1048576   75.95 µs      │ 411.1 µs      │ 116.6 µs      │ 132 µs        │ 10000   │ 10000
│  │                  13.8 GB/s     │ 2.55 GB/s     │ 8.991 GB/s    │ 7.943 GB/s    │         │
│  ├─ md                            │               │               │               │         │
│  │  ╰─ md5                        │               │               │               │         │
│  │     ├─ 4096      5.957 µs      │ 25.37 µs      │ 6.041 µs      │ 6.154 µs      │ 10000   │ 10000
│  │     │            687.5 MB/s    │ 161.4 MB/s    │ 678 MB/s      │ 665.5 MB/s    │         │
│  │     ├─ 16384     23.7 µs       │ 46.12 µs      │ 23.83 µs      │ 24.09 µs      │ 10000   │ 10000
│  │     │            691 MB/s      │ 355.2 MB/s    │ 687.4 MB/s    │ 680 MB/s      │         │
│  │     ├─ 65536     94.79 µs      │ 197.4 µs      │ 95.08 µs      │ 96.4 µs       │ 10000   │ 10000
│  │     │            691.3 MB/s    │ 331.8 MB/s    │ 689.2 MB/s    │ 679.7 MB/s    │         │
│  │     ╰─ 1048576   1.516 ms      │ 2.011 ms      │ 1.523 ms      │ 1.529 ms      │ 10000   │ 10000
│  │                  691.6 MB/s    │ 521.2 MB/s    │ 688 MB/s      │ 685.4 MB/s    │         │
│  ╰─ sha                           │               │               │               │         │
│     ├─ sha1                       │               │               │               │         │
│     │  ├─ 4096      2.415 µs      │ 34.83 µs      │ 3.124 µs      │ 3.515 µs      │ 10000   │ 10000
│     │  │            1.695 GB/s    │ 117.5 MB/s    │ 1.311 GB/s    │ 1.164 GB/s    │         │
│     │  ├─ 16384     6.832 µs      │ 34.87 µs      │ 7.749 µs      │ 8.255 µs      │ 10000   │ 10000
│     │  │            2.398 GB/s    │ 469.8 MB/s    │ 2.114 GB/s    │ 1.984 GB/s    │         │
│     │  ├─ 65536     27.41 µs      │ 73.2 µs       │ 27.54 µs      │ 28.12 µs      │ 10000   │ 10000
│     │  │            2.39 GB/s     │ 895.2 MB/s    │ 2.379 GB/s    │ 2.33 GB/s     │         │
│     │  ╰─ 1048576   440 µs        │ 1.124 ms      │ 440.3 µs      │ 444.8 µs      │ 10000   │ 10000
│     │               2.382 GB/s    │ 932.7 MB/s    │ 2.381 GB/s    │ 2.357 GB/s    │         │
│     ├─ sha2_256                   │               │               │               │         │
│     │   ├─ 4096     2.415 µs      │ 47.87 µs      │ 3.083 µs      │ 3.458 µs      │ 10000   │ 10000
│     │   │           1.695 GB/s    │ 85.55 MB/s    │ 1.328 GB/s    │ 1.184 GB/s    │         │
│     │   ├─ 16384    6.749 µs      │ 35.45 µs      │ 7.665 µs      │ 8.172 µs      │ 10000   │ 10000
│     │   │           2.427 GB/s    │ 462 MB/s      │ 2.137 GB/s    │ 2.004 GB/s    │         │
│     │   ├─ 65536    27.08 µs      │ 72.37 µs      │ 27.2 µs       │ 27.74 µs      │ 10000   │ 10000
│     │   │           2.419 GB/s    │ 905.5 MB/s    │ 2.408 GB/s    │ 2.361 GB/s    │         │
│     │   ╰─ 1048576  434.7 µs      │ 1.224 ms      │ 434.9 µs      │ 438.8 µs      │ 10000   │ 10000
│     │               2.411 GB/s    │ 856 MB/s      │ 2.41 GB/s     │ 2.389 GB/s    │         │
│     ╰─ sha3_256                   │               │               │               │         │
│        ├─ 4096      6.54 µs       │ 24.99 µs      │ 6.707 µs      │ 6.904 µs      │ 10000   │ 10000
│        │            626.2 MB/s    │ 163.8 MB/s    │ 610.6 MB/s    │ 593.2 MB/s    │         │
│        ├─ 16384     25.62 µs      │ 51.79 µs      │ 26.04 µs      │ 26.46 µs      │ 10000   │ 10000
│        │            639.3 MB/s    │ 316.3 MB/s    │ 629.1 MB/s    │ 619 MB/s      │         │
│        ├─ 65536     102.3 µs      │ 201.6 µs      │ 103.5 µs      │ 104.9 µs      │ 10000   │ 10000
│        │            640.1 MB/s    │ 325 MB/s      │ 632.6 MB/s    │ 624.3 MB/s    │         │
│        ╰─ 1048576   1.655 ms      │ 2.026 ms      │ 1.669 ms      │ 1.675 ms      │ 10000   │ 10000
│                     633.5 MB/s    │ 517.4 MB/s    │ 627.9 MB/s    │ 625.9 MB/s    │         │
╰─ non_crypto                       │               │               │               │         │
   ├─ adler                         │               │               │               │         │
   │  ├─ 4096         618.9 ns      │ 2.467 µs      │ 645 ns        │ 658.3 ns      │ 10000   │ 80000
   │  │               6.617 GB/s    │ 1.659 GB/s    │ 6.349 GB/s    │ 6.221 GB/s    │         │
   │  ├─ 16384        2.519 µs      │ 9.853 µs      │ 2.561 µs      │ 2.643 µs      │ 10000   │ 20000
   │  │               6.502 GB/s    │ 1.662 GB/s    │ 6.395 GB/s    │ 6.196 GB/s    │         │
   │  ├─ 65536        10.83 µs      │ 29.91 µs      │ 11.24 µs      │ 11.45 µs      │ 10000   │ 10000
   │  │               6.05 GB/s     │ 2.19 GB/s     │ 5.825 GB/s    │ 5.723 GB/s    │         │
   │  ╰─ 1048576      174.9 µs      │ 272.7 µs      │ 186.4 µs      │ 185.4 µs      │ 10000   │ 10000
   │                  5.993 GB/s    │ 3.845 GB/s    │ 5.622 GB/s    │ 5.652 GB/s    │         │
   ╰─ crc                           │               │               │               │         │
      ├─ 4096         447.1 ns      │ 1.897 µs      │ 457.4 ns      │ 470.4 ns      │ 10000   │ 160000
      │               9.161 GB/s    │ 2.158 GB/s    │ 8.953 GB/s    │ 8.707 GB/s    │         │
      ├─ 16384        1.811 µs      │ 11.22 µs      │ 1.874 µs      │ 1.94 µs       │ 10000   │ 20000
      │               9.043 GB/s    │ 1.459 GB/s    │ 8.741 GB/s    │ 8.442 GB/s    │         │
      ├─ 65536        7.374 µs      │ 29.33 µs      │ 7.499 µs      │ 7.682 µs      │ 10000   │ 10000
      │               8.887 GB/s    │ 2.234 GB/s    │ 8.739 GB/s    │ 8.53 GB/s     │         │
      ╰─ 1048576      119.5 µs      │ 209.7 µs      │ 119.7 µs      │ 120.8 µs      │ 10000   │ 10000
                      8.768 GB/s    │ 4.998 GB/s    │ 8.759 GB/s    │ 8.674 GB/s    │         │
```
</details>

### AMD Ryzen 9 3900X 12-Core Processor (x86_64-unknown-linux-gnu)

```
crc32    - 15.8 GB/s
adler    - 4.59 GB/s
blake3   - 4.50 GB/s
sha2_256 - 1.96 GB/s
sha1     - 1.80 GB/s
blake2b  -  807 MB/s
```

<details>
<summary>Expand full test info</summary>
```
Timer precision: 20 ns
checksums      fastest       │ slowest       │ median        │ mean          │ samples │ iters
├─ adler                     │               │               │               │         │
│  ├─ 4096     769.7 ns      │ 37.39 µs      │ 779.7 ns      │ 788.3 ns      │ 10000   │ 10000
│  ├─ 16384    2.979 µs      │ 16.75 µs      │ 2.999 µs      │ 3.02 µs       │ 10000   │ 10000
│  ├─ 65536    12.77 µs      │ 51.32 µs      │ 12.87 µs      │ 12.97 µs      │ 10000   │ 10000
│  ╰─ 1048576  209.5 µs      │ 1.055 ms      │ 212.4 µs      │ 217.7 µs      │ 10000   │ 10000
├─ blake2b_32                │               │               │               │         │
│  ├─ 4096     4.829 µs      │ 17.51 µs      │ 4.839 µs      │ 4.875 µs      │ 10000   │ 10000
│  ├─ 16384    19.19 µs      │ 30.61 µs      │ 19.21 µs      │ 19.34 µs      │ 10000   │ 10000
│  ├─ 65536    76.19 µs      │ 112.3 µs      │ 76.7 µs       │ 77.22 µs      │ 10000   │ 10000
│  ╰─ 1048576  1.221 ms      │ 2.129 ms      │ 1.237 ms      │ 1.238 ms      │ 10000   │ 10000
├─ blake3                    │               │               │               │         │
│  ├─ 4096     1.389 µs      │ 29.21 µs      │ 1.409 µs      │ 1.422 µs      │ 10000   │ 10000
│  ├─ 16384    3.529 µs      │ 9.489 µs      │ 3.559 µs      │ 3.583 µs      │ 10000   │ 10000
│  ├─ 65536    13.76 µs      │ 24.98 µs      │ 13.89 µs      │ 14.01 µs      │ 10000   │ 10000
│  ╰─ 1048576  211.9 µs      │ 356.1 µs      │ 222.8 µs      │ 222.2 µs      │ 10000   │ 10000
├─ crc                       │               │               │               │         │
│  ├─ 4096     251 ns        │ 2.617 µs      │ 253.5 ns      │ 256.1 ns      │ 10000   │ 80000
│  ├─ 16384    1.004 µs      │ 6.054 µs      │ 1.009 µs      │ 1.018 µs      │ 10000   │ 20000
│  ├─ 65536    3.949 µs      │ 13.85 µs      │ 3.979 µs      │ 3.998 µs      │ 10000   │ 10000
│  ╰─ 1048576  59.31 µs      │ 101.7 µs      │ 63.28 µs      │ 63.29 µs      │ 10000   │ 10000
├─ sha1                      │               │               │               │         │
│  ├─ 4096     2.209 µs      │ 17.66 µs      │ 2.229 µs      │ 2.242 µs      │ 10000   │ 10000
│  ├─ 16384    8.609 µs      │ 18.16 µs      │ 8.659 µs      │ 8.692 µs      │ 10000   │ 10000
│  ├─ 65536    34.43 µs      │ 45.86 µs      │ 34.44 µs      │ 34.56 µs      │ 10000   │ 10000
│  ╰─ 1048576  543.9 µs      │ 567.9 µs      │ 552.1 µs      │ 552.2 µs      │ 10000   │ 10000
╰─ sha256                    │               │               │               │         │
   ├─ 4096     2.029 µs      │ 11.79 µs      │ 2.039 µs      │ 2.05 µs       │ 10000   │ 10000
   ├─ 16384    7.879 µs      │ 28.27 µs      │ 7.969 µs      │ 8.02 µs       │ 10000   │ 10000
   ├─ 65536    31.32 µs      │ 57.85 µs      │ 31.69 µs      │ 31.96 µs      │ 10000   │ 10000
   ╰─ 1048576  500.4 µs      │ 538.8 µs      │ 508.2 µs      │ 508.9 µs      │ 10000   │ 10000
```
</details>
